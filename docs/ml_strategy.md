# ML Enhanced Trading Strategy Documentation

## 概述

ML Enhanced Strategy 是一個結合機器學習模型與固定比率策略的進階交易系統。該策略使用隨機森林分類器來預測交易結果，並根據預測結果來過濾高風險交易機會和優化持倉管理。

## 策略組成

### 1. 基礎策略

- 繼承自 FixedRatioStrategy
- 保留原有的固定比率倉位管理邏輯
- 維持原有的停損機制

### 2. 機器學習增強

- 使用隨機森林分類器進行交易結果預測
- 將交易結果分為 8 個類別：
  - 重大虧損 (Major Loss)
  - 大額虧損 (Large Loss)
  - 中額虧損 (Medium Loss)
  - 小額虧損 (Small Loss)
  - 小額獲利 (Small Profit)
  - 中額獲利 (Medium Profit)
  - 大額獲利 (Large Profit)
  - 重大獲利 (Major Profit)

## 特徵工程

### 技術指標特徵

1. 移動平均線

   - SMA 5/20/60
   - 價格與均線距離

2. 動量指標

   - RSI
   - MACD
   - ROC (Rate of Change)
   - Momentum

3. 波動指標

   - 布林帶寬度
   - 布林帶位置
   - ATR

4. 成交量指標
   - 成交量 SMA 5/20
   - 成交量比率

### 交易相關特徵

- 價格級別 (Price Level)
- 持倉大小 (Position Size)

## 風險管理機制

### 1. 開倉前風險評估

- 載入訓練好的模型
- 在新的時間區間進行回測
- 生成回測報告和交易記錄

## 效能評估

### 評估指標

1. 交易次數比較

   - 原始策略 vs ML 增強版
   - 觀察濾網效果

2. 獲利指標

   - 總收益率
   - 最大回撤
   - Sharpe 比率

3. 風險指標
   - 停損觸發率
   - 平均持倉時間
   - 勝率變化

### 結果分析

- 檢視交易記錄 (res/ml_enhanced_trades.csv)
- 分析模型預測準確度
- 評估風險控制效果

## 優化建議

1. 特徵優化

   - 根據特徵重要性圖表調整特徵
   - 考慮添加新的技術指標
   - 優化特徵計算方法

2. 參數調優

   - 使用交叉驗證優化風險閾值
   - 根據不同市場條件調整參數
   - 考慮動態調整風險閾值

3. 模型改進
   - 嘗試其他機器學習算法
   - 實現集成學習方法
   - 考慮時間序列特性
